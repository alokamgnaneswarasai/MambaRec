Arguments:
backbone sasmamba
batch_size 16
dataset tracks2000
device cuda:7
dropout_rate 0.5
eval_neg_sample 100
hidden_units 32
inference_only False
l2_emb 0.0
lr 0.0005
maxlen 2000
name mamba
num_blocks 2
num_epochs 501
num_heads 1
state_dict_path None
train_dir tracks256_default/

user_count: 25001
item count: 8163986
25001
average sequence length: 1656.24
parameters_count: 1033173122
loss in epoch 1 iteration 1561: 0.8630375266075134
loss in epoch 2 iteration 1561: 0.8133091926574707
loss in epoch 3 iteration 1561: 0.7620497941970825
loss in epoch 4 iteration 1561: 0.6095514297485352
loss in epoch 5 iteration 1561: 0.6332085132598877
Evaluatingepoch:5, time: 2343636.291027(s), valid (NDCG@5: 0.6229, HR@5: 0.7569, NDCG@10: 0.6412, HR@10: 0.8128, NDCG@20: 0.6503, HR@20: 0.8487), test (NDCG@5: 0.6133, HR@5: 0.7476, NDCG@10: 0.6317, HR@10: 0.8040, NDCG@20: 0.6415, HR@20: 0.8425)
loss in epoch 6 iteration 1561: 0.5370640158653259
loss in epoch 7 iteration 1561: 0.4881190061569214
loss in epoch 8 iteration 1561: 0.46202966570854187
loss in epoch 9 iteration 1561: 0.4137786030769348
loss in epoch 10 iteration 1561: 0.39072751998901367
Evaluatingepoch:10, time: 4651918.942928(s), valid (NDCG@5: 0.6204, HR@5: 0.7599, NDCG@10: 0.6385, HR@10: 0.8152, NDCG@20: 0.6469, HR@20: 0.8482), test (NDCG@5: 0.6127, HR@5: 0.7505, NDCG@10: 0.6309, HR@10: 0.8061, NDCG@20: 0.6398, HR@20: 0.8412)
loss in epoch 11 iteration 1561: 0.38755473494529724
loss in epoch 12 iteration 1561: 0.3832632899284363
loss in epoch 13 iteration 1561: 0.34301862120628357
loss in epoch 14 iteration 1561: 0.3350834548473358
loss in epoch 15 iteration 1561: 0.3148752748966217
Evaluatingepoch:15, time: 7016965.771675(s), valid (NDCG@5: 0.6302, HR@5: 0.7638, NDCG@10: 0.6468, HR@10: 0.8145, NDCG@20: 0.6550, HR@20: 0.8467), test (NDCG@5: 0.6234, HR@5: 0.7523, NDCG@10: 0.6403, HR@10: 0.8039, NDCG@20: 0.6490, HR@20: 0.8380)
loss in epoch 16 iteration 1561: 0.35128703713417053
loss in epoch 17 iteration 1561: 0.2927170395851135
loss in epoch 18 iteration 1561: 0.3058978021144867
loss in epoch 19 iteration 1561: 0.3032005727291107
loss in epoch 20 iteration 1561: 0.2943052649497986
Evaluatingepoch:20, time: 9483926.039219(s), valid (NDCG@5: 0.6456, HR@5: 0.7674, NDCG@10: 0.6605, HR@10: 0.8130, NDCG@20: 0.6687, HR@20: 0.8450), test (NDCG@5: 0.6342, HR@5: 0.7544, NDCG@10: 0.6496, HR@10: 0.8014, NDCG@20: 0.6582, HR@20: 0.8354)
loss in epoch 21 iteration 1561: 0.2727527618408203
loss in epoch 22 iteration 1561: 0.27122777700424194
loss in epoch 23 iteration 1561: 0.2607731223106384
loss in epoch 24 iteration 1561: 0.2608712911605835
loss in epoch 25 iteration 1561: 0.2507476210594177
Evaluatingepoch:25, time: 11871600.537300(s), valid (NDCG@5: 0.6571, HR@5: 0.7697, NDCG@10: 0.6709, HR@10: 0.8119, NDCG@20: 0.6790, HR@20: 0.8441), test (NDCG@5: 0.6425, HR@5: 0.7563, NDCG@10: 0.6573, HR@10: 0.8018, NDCG@20: 0.6658, HR@20: 0.8351)
loss in epoch 26 iteration 1561: 0.2527780830860138
loss in epoch 27 iteration 1561: 0.24138781428337097
loss in epoch 28 iteration 1561: 0.23973405361175537
loss in epoch 29 iteration 1561: 0.23769265413284302
loss in epoch 30 iteration 1561: 0.24157340824604034
Evaluatingepoch:30, time: 14289070.102930(s), valid (NDCG@5: 0.6640, HR@5: 0.7721, NDCG@10: 0.6771, HR@10: 0.8122, NDCG@20: 0.6848, HR@20: 0.8427), test (NDCG@5: 0.6511, HR@5: 0.7602, NDCG@10: 0.6649, HR@10: 0.8026, NDCG@20: 0.6730, HR@20: 0.8346)
loss in epoch 31 iteration 1561: 0.24876932799816132
loss in epoch 32 iteration 1561: 0.22611209750175476
loss in epoch 33 iteration 1561: 0.23604387044906616
loss in epoch 34 iteration 1561: 0.224262073636055
loss in epoch 35 iteration 1561: 0.22324341535568237
Evaluatingepoch:35, time: 16749251.254320(s), valid (NDCG@5: 0.6702, HR@5: 0.7740, NDCG@10: 0.6830, HR@10: 0.8134, NDCG@20: 0.6905, HR@20: 0.8430), test (NDCG@5: 0.6570, HR@5: 0.7612, NDCG@10: 0.6709, HR@10: 0.8036, NDCG@20: 0.6788, HR@20: 0.8350)
loss in epoch 36 iteration 1561: 0.2162429243326187
loss in epoch 37 iteration 1561: 0.22898618876934052
loss in epoch 38 iteration 1561: 0.20700769126415253
loss in epoch 39 iteration 1561: 0.21021738648414612
loss in epoch 40 iteration 1561: 0.2125818282365799
Evaluatingepoch:40, time: 19144804.435253(s), valid (NDCG@5: 0.6718, HR@5: 0.7765, NDCG@10: 0.6843, HR@10: 0.8148, NDCG@20: 0.6920, HR@20: 0.8449), test (NDCG@5: 0.6599, HR@5: 0.7638, NDCG@10: 0.6737, HR@10: 0.8063, NDCG@20: 0.6817, HR@20: 0.8378)
loss in epoch 41 iteration 1561: 0.2087872326374054
loss in epoch 42 iteration 1561: 0.19630864262580872
loss in epoch 43 iteration 1561: 0.19729728996753693
loss in epoch 44 iteration 1561: 0.21791449189186096
loss in epoch 45 iteration 1561: 0.20410087704658508
Evaluatingepoch:45, time: 21567260.883570(s), valid (NDCG@5: 0.6742, HR@5: 0.7793, NDCG@10: 0.6860, HR@10: 0.8155, NDCG@20: 0.6937, HR@20: 0.8458), test (NDCG@5: 0.6595, HR@5: 0.7648, NDCG@10: 0.6730, HR@10: 0.8062, NDCG@20: 0.6815, HR@20: 0.8394)
loss in epoch 46 iteration 1561: 0.21248582005500793
loss in epoch 47 iteration 1561: 0.2094006985425949
loss in epoch 48 iteration 1561: 0.2129257768392563
loss in epoch 49 iteration 1561: 0.19121821224689484
loss in epoch 50 iteration 1561: 0.1902017742395401
Evaluatingepoch:50, time: 23981107.494116(s), valid (NDCG@5: 0.6784, HR@5: 0.7809, NDCG@10: 0.6908, HR@10: 0.8188, NDCG@20: 0.6979, HR@20: 0.8469), test (NDCG@5: 0.6655, HR@5: 0.7673, NDCG@10: 0.6791, HR@10: 0.8090, NDCG@20: 0.6872, HR@20: 0.8410)
loss in epoch 51 iteration 1561: 0.1940770000219345
loss in epoch 52 iteration 1561: 0.20135562121868134
loss in epoch 53 iteration 1561: 0.18886208534240723
loss in epoch 54 iteration 1561: 0.21185827255249023
loss in epoch 55 iteration 1561: 0.18110907077789307
Evaluatingepoch:55, time: 26444658.942699(s), valid (NDCG@5: 0.6830, HR@5: 0.7826, NDCG@10: 0.6956, HR@10: 0.8211, NDCG@20: 0.7027, HR@20: 0.8493), test (NDCG@5: 0.6694, HR@5: 0.7698, NDCG@10: 0.6828, HR@10: 0.8105, NDCG@20: 0.6909, HR@20: 0.8428)
loss in epoch 56 iteration 1561: 0.19222475588321686
loss in epoch 57 iteration 1561: 0.18940311670303345
loss in epoch 58 iteration 1561: 0.1995772421360016
loss in epoch 59 iteration 1561: 0.18617728352546692
loss in epoch 60 iteration 1561: 0.19929492473602295
Evaluatingepoch:60, time: 28932973.446131(s), valid (NDCG@5: 0.6847, HR@5: 0.7836, NDCG@10: 0.6973, HR@10: 0.8221, NDCG@20: 0.7047, HR@20: 0.8511), test (NDCG@5: 0.6713, HR@5: 0.7703, NDCG@10: 0.6853, HR@10: 0.8130, NDCG@20: 0.6935, HR@20: 0.8454)
loss in epoch 61 iteration 1561: 0.1691809892654419
loss in epoch 62 iteration 1561: 0.19422687590122223
loss in epoch 63 iteration 1561: 0.19401250779628754
loss in epoch 64 iteration 1561: 0.17994324862957
loss in epoch 65 iteration 1561: 0.19519388675689697
Evaluatingepoch:65, time: 31424560.529470(s), valid (NDCG@5: 0.6862, HR@5: 0.7845, NDCG@10: 0.6992, HR@10: 0.8243, NDCG@20: 0.7066, HR@20: 0.8536), test (NDCG@5: 0.6729, HR@5: 0.7716, NDCG@10: 0.6871, HR@10: 0.8153, NDCG@20: 0.6954, HR@20: 0.8481)
loss in epoch 66 iteration 1561: 0.19067096710205078
loss in epoch 67 iteration 1561: 0.1911182850599289
loss in epoch 68 iteration 1561: 0.18686659634113312
loss in epoch 69 iteration 1561: 0.18533942103385925
loss in epoch 70 iteration 1561: 0.18792583048343658
Evaluatingepoch:70, time: 33893914.081097(s), valid (NDCG@5: 0.6891, HR@5: 0.7863, NDCG@10: 0.7020, HR@10: 0.8259, NDCG@20: 0.7098, HR@20: 0.8565), test (NDCG@5: 0.6768, HR@5: 0.7748, NDCG@10: 0.6906, HR@10: 0.8173, NDCG@20: 0.6986, HR@20: 0.8490)
loss in epoch 71 iteration 1561: 0.17513005435466766
loss in epoch 72 iteration 1561: 0.17836198210716248
loss in epoch 73 iteration 1561: 0.19182519614696503
loss in epoch 74 iteration 1561: 0.1900983452796936
loss in epoch 75 iteration 1561: 0.18621130287647247
Evaluatingepoch:75, time: 36318537.990808(s), valid (NDCG@5: 0.6905, HR@5: 0.7874, NDCG@10: 0.7035, HR@10: 0.8272, NDCG@20: 0.7109, HR@20: 0.8565), test (NDCG@5: 0.6783, HR@5: 0.7768, NDCG@10: 0.6919, HR@10: 0.8181, NDCG@20: 0.6997, HR@20: 0.8489)
loss in epoch 76 iteration 1561: 0.17842638492584229
loss in epoch 77 iteration 1561: 0.18043720722198486
loss in epoch 78 iteration 1561: 0.18094460666179657
loss in epoch 79 iteration 1561: 0.18391406536102295
loss in epoch 80 iteration 1561: 0.17864695191383362
Evaluatingepoch:80, time: 38748438.032627(s), valid (NDCG@5: 0.6968, HR@5: 0.7902, NDCG@10: 0.7096, HR@10: 0.8292, NDCG@20: 0.7168, HR@20: 0.8580), test (NDCG@5: 0.6843, HR@5: 0.7778, NDCG@10: 0.6981, HR@10: 0.8200, NDCG@20: 0.7062, HR@20: 0.8522)
loss in epoch 81 iteration 1561: 0.18690964579582214
loss in epoch 82 iteration 1561: 0.1821957528591156
loss in epoch 83 iteration 1561: 0.17813529074192047
loss in epoch 84 iteration 1561: 0.1908654272556305
loss in epoch 85 iteration 1561: 0.1775411069393158
Evaluatingepoch:85, time: 41168695.267916(s), valid (NDCG@5: 0.6999, HR@5: 0.7921, NDCG@10: 0.7123, HR@10: 0.8300, NDCG@20: 0.7196, HR@20: 0.8589), test (NDCG@5: 0.6848, HR@5: 0.7781, NDCG@10: 0.6984, HR@10: 0.8199, NDCG@20: 0.7064, HR@20: 0.8513)
loss in epoch 86 iteration 1561: 0.18061073124408722
loss in epoch 87 iteration 1561: 0.176534041762352
loss in epoch 88 iteration 1561: 0.18014036118984222
loss in epoch 89 iteration 1561: 0.17742189764976501
loss in epoch 90 iteration 1561: 0.1655091494321823
Evaluatingepoch:90, time: 43641546.348572(s), valid (NDCG@5: 0.7012, HR@5: 0.7914, NDCG@10: 0.7138, HR@10: 0.8298, NDCG@20: 0.7209, HR@20: 0.8577), test (NDCG@5: 0.6891, HR@5: 0.7795, NDCG@10: 0.7025, HR@10: 0.8202, NDCG@20: 0.7105, HR@20: 0.8519)
loss in epoch 91 iteration 1561: 0.17472337186336517
loss in epoch 92 iteration 1561: 0.17491702735424042
loss in epoch 93 iteration 1561: 0.17492257058620453
loss in epoch 94 iteration 1561: 0.19007660448551178
loss in epoch 95 iteration 1561: 0.17647822201251984
Evaluatingepoch:95, time: 46245428.992510(s), valid (NDCG@5: 0.7045, HR@5: 0.7936, NDCG@10: 0.7169, HR@10: 0.8314, NDCG@20: 0.7238, HR@20: 0.8589), test (NDCG@5: 0.6902, HR@5: 0.7807, NDCG@10: 0.7035, HR@10: 0.8215, NDCG@20: 0.7115, HR@20: 0.8530)
loss in epoch 96 iteration 1561: 0.18400146067142487
loss in epoch 97 iteration 1561: 0.17586055397987366
loss in epoch 98 iteration 1561: 0.17805597186088562
loss in epoch 99 iteration 1561: 0.17871364951133728
loss in epoch 100 iteration 1561: 0.17289228737354279
Evaluatingepoch:100, time: 48887238.117695(s), valid (NDCG@5: 0.7095, HR@5: 0.7940, NDCG@10: 0.7216, HR@10: 0.8311, NDCG@20: 0.7286, HR@20: 0.8586), test (NDCG@5: 0.6953, HR@5: 0.7835, NDCG@10: 0.7081, HR@10: 0.8226, NDCG@20: 0.7161, HR@20: 0.8541)
loss in epoch 101 iteration 1561: 0.18144671618938446
loss in epoch 102 iteration 1561: 0.17350852489471436
loss in epoch 103 iteration 1561: 0.19342423975467682
loss in epoch 104 iteration 1561: 0.1702941507101059
loss in epoch 105 iteration 1561: 0.1694265455007553
Evaluatingepoch:105, time: 51534521.259069(s), valid (NDCG@5: 0.7089, HR@5: 0.7932, NDCG@10: 0.7214, HR@10: 0.8312, NDCG@20: 0.7285, HR@20: 0.8592), test (NDCG@5: 0.6958, HR@5: 0.7820, NDCG@10: 0.7091, HR@10: 0.8231, NDCG@20: 0.7169, HR@20: 0.8538)
loss in epoch 106 iteration 1561: 0.17535167932510376
loss in epoch 107 iteration 1561: 0.18935757875442505
loss in epoch 108 iteration 1561: 0.15514490008354187
loss in epoch 109 iteration 1561: 0.17208881676197052
loss in epoch 110 iteration 1561: 0.18190184235572815
Evaluating