Arguments:
backbone sasmamba
batch_size 16
dataset KuaiRand1000
device cuda:2
dropout_rate 0.5
eval_neg_sample 100
hidden_units 32
inference_only False
l2_emb 0.0
lr 0.0005
maxlen 1000
name mamba
num_blocks 2
num_epochs 500
num_heads 1
state_dict_path None
train_dir tracks256_default/

user_count: 26858
item count: 4524611
26858
average sequence length: 853.65
parameters_count: 1025296929
loss in epoch 1 iteration 1677: 0.8868964910507202
loss in epoch 2 iteration 1677: 0.8094964027404785
loss in epoch 3 iteration 1677: 0.7299651503562927
loss in epoch 4 iteration 1677: 0.6789706349372864
loss in epoch 5 iteration 1677: 0.6604535579681396
Evaluatingepoch:5, time: 1636801.167011(s), valid (NDCG@5: 0.5888, HR@5: 0.7404, NDCG@10: 0.6115, HR@10: 0.8100, NDCG@20: 0.6220, HR@20: 0.8511), test (NDCG@5: 0.5907, HR@5: 0.7410, NDCG@10: 0.6134, HR@10: 0.8105, NDCG@20: 0.6234, HR@20: 0.8495)
loss in epoch 6 iteration 1677: 0.6279281973838806
loss in epoch 7 iteration 1677: 0.6259847283363342
loss in epoch 8 iteration 1677: 0.6089209318161011
loss in epoch 9 iteration 1677: 0.5554237961769104
loss in epoch 10 iteration 1677: 0.5398913025856018
Evaluatingepoch:10, time: 3271003.896952(s), valid (NDCG@5: 0.5860, HR@5: 0.7401, NDCG@10: 0.6102, HR@10: 0.8143, NDCG@20: 0.6206, HR@20: 0.8549), test (NDCG@5: 0.5823, HR@5: 0.7401, NDCG@10: 0.6062, HR@10: 0.8131, NDCG@20: 0.6166, HR@20: 0.8539)
loss in epoch 11 iteration 1677: 0.5362053513526917
loss in epoch 12 iteration 1677: 0.49965140223503113
loss in epoch 13 iteration 1677: 0.48848000168800354
loss in epoch 14 iteration 1677: 0.4502068758010864
loss in epoch 15 iteration 1677: 0.45588675141334534
Evaluatingepoch:15, time: 4905794.903994(s), valid (NDCG@5: 0.5881, HR@5: 0.7367, NDCG@10: 0.6114, HR@10: 0.8083, NDCG@20: 0.6216, HR@20: 0.8483), test (NDCG@5: 0.5809, HR@5: 0.7317, NDCG@10: 0.6048, HR@10: 0.8046, NDCG@20: 0.6152, HR@20: 0.8454)
loss in epoch 16 iteration 1677: 0.4290546774864197
loss in epoch 17 iteration 1677: 0.43190228939056396
loss in epoch 18 iteration 1677: 0.40086713433265686
loss in epoch 19 iteration 1677: 0.40998756885528564
loss in epoch 20 iteration 1677: 0.41228339076042175
Evaluatingepoch:20, time: 6540490.494251(s), valid (NDCG@5: 0.5945, HR@5: 0.7371, NDCG@10: 0.6164, HR@10: 0.8043, NDCG@20: 0.6262, HR@20: 0.8427), test (NDCG@5: 0.5839, HR@5: 0.7295, NDCG@10: 0.6080, HR@10: 0.8029, NDCG@20: 0.6176, HR@20: 0.8405)
loss in epoch 21 iteration 1677: 0.4162587821483612
loss in epoch 22 iteration 1677: 0.3923863470554352
loss in epoch 23 iteration 1677: 0.3685528635978699
loss in epoch 24 iteration 1677: 0.3808003067970276
loss in epoch 25 iteration 1677: 0.36190634965896606
Evaluatingepoch:25, time: 8176160.547733(s), valid (NDCG@5: 0.6049, HR@5: 0.7419, NDCG@10: 0.6251, HR@10: 0.8037, NDCG@20: 0.6348, HR@20: 0.8418), test (NDCG@5: 0.5906, HR@5: 0.7304, NDCG@10: 0.6126, HR@10: 0.7978, NDCG@20: 0.6229, HR@20: 0.8380)
loss in epoch 26 iteration 1677: 0.36053961515426636
loss in epoch 27 iteration 1677: 0.35351285338401794
loss in epoch 28 iteration 1677: 0.3558225631713867
loss in epoch 29 iteration 1677: 0.35345178842544556
loss in epoch 30 iteration 1677: 0.3303665816783905
Evaluatingepoch:30, time: 9810663.509846(s), valid (NDCG@5: 0.6109, HR@5: 0.7444, NDCG@10: 0.6309, HR@10: 0.8055, NDCG@20: 0.6403, HR@20: 0.8425), test (NDCG@5: 0.5980, HR@5: 0.7335, NDCG@10: 0.6192, HR@10: 0.7981, NDCG@20: 0.6291, HR@20: 0.8367)
loss in epoch 31 iteration 1677: 0.3444456458091736
loss in epoch 32 iteration 1677: 0.34212854504585266
loss in epoch 33 iteration 1677: 0.3182215988636017
loss in epoch 34 iteration 1677: 0.31473779678344727
loss in epoch 35 iteration 1677: 0.3286457657814026
Evaluatingepoch:35, time: 11445680.491686(s), valid (NDCG@5: 0.6130, HR@5: 0.7467, NDCG@10: 0.6322, HR@10: 0.8055, NDCG@20: 0.6414, HR@20: 0.8417), test (NDCG@5: 0.5991, HR@5: 0.7336, NDCG@10: 0.6201, HR@10: 0.7979, NDCG@20: 0.6298, HR@20: 0.8362)
loss in epoch 36 iteration 1677: 0.3144012987613678
loss in epoch 37 iteration 1677: 0.32180389761924744
loss in epoch 38 iteration 1677: 0.31471508741378784
loss in epoch 39 iteration 1677: 0.31749048829078674
loss in epoch 40 iteration 1677: 0.3131447732448578
Evaluatingepoch:40, time: 13079908.582449(s), valid (NDCG@5: 0.6148, HR@5: 0.7447, NDCG@10: 0.6343, HR@10: 0.8043, NDCG@20: 0.6437, HR@20: 0.8411), test (NDCG@5: 0.6019, HR@5: 0.7337, NDCG@10: 0.6233, HR@10: 0.7994, NDCG@20: 0.6323, HR@20: 0.8348)
loss in epoch 41 iteration 1677: 0.3125678598880768
loss in epoch 42 iteration 1677: 0.30695840716362
loss in epoch 43 iteration 1677: 0.31810617446899414
loss in epoch 44 iteration 1677: 0.30695605278015137
loss in epoch 45 iteration 1677: 0.3132346570491791
Evaluatingepoch:45, time: 14714510.868073(s), valid (NDCG@5: 0.6199, HR@5: 0.7455, NDCG@10: 0.6395, HR@10: 0.8054, NDCG@20: 0.6482, HR@20: 0.8398), test (NDCG@5: 0.6048, HR@5: 0.7357, NDCG@10: 0.6257, HR@10: 0.7997, NDCG@20: 0.6351, HR@20: 0.8367)
loss in epoch 46 iteration 1677: 0.29916802048683167
loss in epoch 47 iteration 1677: 0.2855589687824249
loss in epoch 48 iteration 1677: 0.2997422218322754
loss in epoch 49 iteration 1677: 0.29691535234451294
loss in epoch 50 iteration 1677: 0.30949923396110535
Evaluatingepoch:50, time: 16348723.367214(s), valid (NDCG@5: 0.6224, HR@5: 0.7477, NDCG@10: 0.6418, HR@10: 0.8069, NDCG@20: 0.6504, HR@20: 0.8408), test (NDCG@5: 0.6091, HR@5: 0.7369, NDCG@10: 0.6296, HR@10: 0.7995, NDCG@20: 0.6393, HR@20: 0.8376)
loss in epoch 51 iteration 1677: 0.2871916890144348
loss in epoch 52 iteration 1677: 0.2874254286289215
loss in epoch 53 iteration 1677: 0.3020639717578888
loss in epoch 54 iteration 1677: 0.2940942049026489
loss in epoch 55 iteration 1677: 0.27883294224739075
Evaluatingepoch:55, time: 17984035.327911(s), valid (NDCG@5: 0.6199, HR@5: 0.7464, NDCG@10: 0.6392, HR@10: 0.8055, NDCG@20: 0.6481, HR@20: 0.8406), test (NDCG@5: 0.6089, HR@5: 0.7383, NDCG@10: 0.6291, HR@10: 0.8001, NDCG@20: 0.6387, HR@20: 0.8376)
loss in epoch 56 iteration 1677: 0.28716570138931274
loss in epoch 57 iteration 1677: 0.28303262591362
loss in epoch 58 iteration 1677: 0.2905387878417969
loss in epoch 59 iteration 1677: 0.29093727469444275
loss in epoch 60 iteration 1677: 0.27709847688674927
Evaluatingepoch:60, time: 19618968.295574(s), valid (NDCG@5: 0.6294, HR@5: 0.7536, NDCG@10: 0.6478, HR@10: 0.8099, NDCG@20: 0.6560, HR@20: 0.8421), test (NDCG@5: 0.6185, HR@5: 0.7450, NDCG@10: 0.6385, HR@10: 0.8061, NDCG@20: 0.6475, HR@20: 0.8414)
loss in epoch 61 iteration 1677: 0.2818428575992584
loss in epoch 62 iteration 1677: 0.27089452743530273
loss in epoch 63 iteration 1677: 0.2860719859600067
loss in epoch 64 iteration 1677: 0.27323874831199646
loss in epoch 65 iteration 1677: 0.2662230432033539
Evaluatingepoch:65, time: 21254307.916641(s), valid (NDCG@5: 0.6257, HR@5: 0.7503, NDCG@10: 0.6450, HR@10: 0.8092, NDCG@20: 0.6535, HR@20: 0.8425), test (NDCG@5: 0.6127, HR@5: 0.7389, NDCG@10: 0.6339, HR@10: 0.8040, NDCG@20: 0.6434, HR@20: 0.8410)
loss in epoch 66 iteration 1677: 0.274461030960083
loss in epoch 67 iteration 1677: 0.2623726725578308
loss in epoch 68 iteration 1677: 0.2815418243408203
loss in epoch 69 iteration 1677: 0.27442535758018494
loss in epoch 70 iteration 1677: 0.2709406614303589
Evaluatingepoch:70, time: 22890142.772913(s), valid (NDCG@5: 0.6250, HR@5: 0.7514, NDCG@10: 0.6440, HR@10: 0.8095, NDCG@20: 0.6526, HR@20: 0.8430), test (NDCG@5: 0.6129, HR@5: 0.7444, NDCG@10: 0.6336, HR@10: 0.8078, NDCG@20: 0.6426, HR@20: 0.8430)
loss in epoch 71 iteration 1677: 0.2796740233898163
loss in epoch 72 iteration 1677: 0.26892703771591187
loss in epoch 73 iteration 1677: 0.26274093985557556
loss in epoch 74 iteration 1677: 0.27246329188346863
loss in epoch 75 iteration 1677: 0.26285290718078613
Evaluatingepoch:75, time: 24525421.344995(s), valid (NDCG@5: 0.6272, HR@5: 0.7541, NDCG@10: 0.6463, HR@10: 0.8126, NDCG@20: 0.6545, HR@20: 0.8448), test (NDCG@5: 0.6116, HR@5: 0.7414, NDCG@10: 0.6334, HR@10: 0.8078, NDCG@20: 0.6426, HR@20: 0.8439)
loss in epoch 76 iteration 1677: 0.2553737461566925
loss in epoch 77 iteration 1677: 0.2646966874599457
loss in epoch 78 iteration 1677: 0.26167234778404236
loss in epoch 79 iteration 1677: 0.2662753760814667
loss in epoch 80 iteration 1677: 0.2598421275615692
Evaluatingepoch:80, time: 26159554.282665(s), valid (NDCG@5: 0.6266, HR@5: 0.7519, NDCG@10: 0.6468, HR@10: 0.8133, NDCG@20: 0.6550, HR@20: 0.8455), test (NDCG@5: 0.6136, HR@5: 0.7430, NDCG@10: 0.6355, HR@10: 0.8099, NDCG@20: 0.6448, HR@20: 0.8464)
loss in epoch 81 iteration 1677: 0.26399508118629456
loss in epoch 82 iteration 1677: 0.2639254629611969
loss in epoch 83 iteration 1677: 0.2655114233493805
loss in epoch 84 iteration 1677: 0.2627744972705841
loss in epoch 85 iteration 1677: 0.26921579241752625
Evaluatingepoch:85, time: 27793615.468502(s), valid (NDCG@5: 0.6322, HR@5: 0.7570, NDCG@10: 0.6508, HR@10: 0.8142, NDCG@20: 0.6592, HR@20: 0.8470), test (NDCG@5: 0.6175, HR@5: 0.7457, NDCG@10: 0.6389, HR@10: 0.8112, NDCG@20: 0.6483, HR@20: 0.8481)
loss in epoch 86 iteration 1677: 0.2576119005680084
loss in epoch 87 iteration 1677: 0.26009470224380493
loss in epoch 88 iteration 1677: 0.26928919553756714
loss in epoch 89 iteration 1677: 0.267357736825943
loss in epoch 90 iteration 1677: 0.25857990980148315
Evaluatingepoch:90, time: 29427690.792561(s), valid (NDCG@5: 0.6304, HR@5: 0.7540, NDCG@10: 0.6504, HR@10: 0.8151, NDCG@20: 0.6585, HR@20: 0.8468), test (NDCG@5: 0.6203, HR@5: 0.7461, NDCG@10: 0.6420, HR@10: 0.8125, NDCG@20: 0.6508, HR@20: 0.8470)
loss in epoch 91 iteration 1677: 0.2670918405056
loss in epoch 92 iteration 1677: 0.25367411971092224
loss in epoch 93 iteration 1677: 0.25683680176734924
loss in epoch 94 iteration 1677: 0.26019397377967834
loss in epoch 95 iteration 1677: 0.2472401112318039
Evaluatingepoch:95, time: 31061589.405060(s), valid (NDCG@5: 0.6356, HR@5: 0.7555, NDCG@10: 0.6554, HR@10: 0.8163, NDCG@20: 0.6636, HR@20: 0.8480), test (NDCG@5: 0.6240, HR@5: 0.7477, NDCG@10: 0.6453, HR@10: 0.8128, NDCG@20: 0.6544, HR@20: 0.8486)
loss in epoch 96 iteration 1677: 0.2630780041217804
loss in epoch 97 iteration 1677: 0.25005605816841125
loss in epoch 98 iteration 1677: 0.25074830651283264
loss in epoch 99 iteration 1677: 0.26307106018066406
loss in epoch 100 iteration 1677: 0.27038124203681946
Evaluatingepoch:100, time: 32695482.246637(s), valid (NDCG@5: 0.6391, HR@5: 0.7577, NDCG@10: 0.6584, HR@10: 0.8168, NDCG@20: 0.6669, HR@20: 0.8499), test (NDCG@5: 0.6261, HR@5: 0.7490, NDCG@10: 0.6478, HR@10: 0.8152, NDCG@20: 0.6564, HR@20: 0.8491)
loss in epoch 101 iteration 1677: 0.2559089958667755
loss in epoch 102 iteration 1677: 0.2542172968387604
loss in epoch 103 iteration 1677: 0.2663176953792572
loss in epoch 104 iteration 1677: 0.2735310196876526
loss in epoch 105 iteration 1677: 0.2591582238674164
Evaluating