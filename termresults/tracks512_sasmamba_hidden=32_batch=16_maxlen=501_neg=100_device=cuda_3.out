Arguments:
backbone sasmamba
batch_size 16
dataset tracks512
device cuda:3
dropout_rate 0.5
eval_neg_sample 100
hidden_units 32
inference_only False
l2_emb 0.0
lr 0.0005
maxlen 501
name mamba
num_blocks 2
num_epochs 501
num_heads 1
state_dict_path None
train_dir tracks256_default/

user_count: 25001
item count: 3541576
25001
average sequence length: 487.54
parameters_count: 1033122562
loss in epoch 1 iteration 1561: 0.9187427759170532
loss in epoch 2 iteration 1561: 0.7899256944656372
loss in epoch 3 iteration 1561: 0.798609733581543
loss in epoch 4 iteration 1561: 0.7359742522239685
loss in epoch 5 iteration 1561: 0.7073363661766052
Evaluatingepoch:5, time: 1512786.243916(s), valid (NDCG@5: 0.6056, HR@5: 0.7303, NDCG@10: 0.6229, HR@10: 0.7832, NDCG@20: 0.6305, HR@20: 0.8130), test (NDCG@5: 0.5969, HR@5: 0.7227, NDCG@10: 0.6143, HR@10: 0.7765, NDCG@20: 0.6225, HR@20: 0.8085)
loss in epoch 6 iteration 1561: 0.6470490097999573
loss in epoch 7 iteration 1561: 0.6294044852256775
loss in epoch 8 iteration 1561: 0.5875051617622375
loss in epoch 9 iteration 1561: 0.5183297395706177
loss in epoch 10 iteration 1561: 0.5150489211082458
Evaluatingepoch:10, time: 3023238.020897(s), valid (NDCG@5: 0.5792, HR@5: 0.7333, NDCG@10: 0.5951, HR@10: 0.7816, NDCG@20: 0.6027, HR@20: 0.8119), test (NDCG@5: 0.5698, HR@5: 0.7233, NDCG@10: 0.5871, HR@10: 0.7760, NDCG@20: 0.5949, HR@20: 0.8069)
loss in epoch 11 iteration 1561: 0.5100407004356384
loss in epoch 12 iteration 1561: 0.4693213403224945
loss in epoch 13 iteration 1561: 0.5061429738998413
loss in epoch 14 iteration 1561: 0.45756906270980835
loss in epoch 15 iteration 1561: 0.430937796831131
Evaluatingepoch:15, time: 4533361.701012(s), valid (NDCG@5: 0.5796, HR@5: 0.7329, NDCG@10: 0.5956, HR@10: 0.7814, NDCG@20: 0.6027, HR@20: 0.8093), test (NDCG@5: 0.5672, HR@5: 0.7180, NDCG@10: 0.5855, HR@10: 0.7737, NDCG@20: 0.5934, HR@20: 0.8049)
loss in epoch 16 iteration 1561: 0.44234612584114075
loss in epoch 17 iteration 1561: 0.4327249825000763
loss in epoch 18 iteration 1561: 0.4109259247779846
loss in epoch 19 iteration 1561: 0.41393452882766724
loss in epoch 20 iteration 1561: 0.3839801549911499
Evaluatingepoch:20, time: 6043330.862045(s), valid (NDCG@5: 0.5841, HR@5: 0.7341, NDCG@10: 0.5987, HR@10: 0.7786, NDCG@20: 0.6063, HR@20: 0.8087), test (NDCG@5: 0.5669, HR@5: 0.7193, NDCG@10: 0.5835, HR@10: 0.7698, NDCG@20: 0.5913, HR@20: 0.8009)
loss in epoch 21 iteration 1561: 0.40711715817451477
loss in epoch 22 iteration 1561: 0.4190208613872528
loss in epoch 23 iteration 1561: 0.3955681324005127
loss in epoch 24 iteration 1561: 0.36799266934394836
loss in epoch 25 iteration 1561: 0.3603649139404297
Evaluatingepoch:25, time: 7553270.652056(s), valid (NDCG@5: 0.5873, HR@5: 0.7348, NDCG@10: 0.6017, HR@10: 0.7782, NDCG@20: 0.6091, HR@20: 0.8080), test (NDCG@5: 0.5758, HR@5: 0.7205, NDCG@10: 0.5918, HR@10: 0.7690, NDCG@20: 0.5996, HR@20: 0.8000)
loss in epoch 26 iteration 1561: 0.3814980387687683
loss in epoch 27 iteration 1561: 0.3515172302722931
loss in epoch 28 iteration 1561: 0.36406585574150085
loss in epoch 29 iteration 1561: 0.3494500517845154
loss in epoch 30 iteration 1561: 0.33299756050109863
Evaluatingepoch:30, time: 9063286.933184(s), valid (NDCG@5: 0.5908, HR@5: 0.7375, NDCG@10: 0.6040, HR@10: 0.7777, NDCG@20: 0.6116, HR@20: 0.8078), test (NDCG@5: 0.5773, HR@5: 0.7215, NDCG@10: 0.5927, HR@10: 0.7682, NDCG@20: 0.6006, HR@20: 0.7996)
loss in epoch 31 iteration 1561: 0.35257861018180847
loss in epoch 32 iteration 1561: 0.34133803844451904
loss in epoch 33 iteration 1561: 0.3204793632030487
loss in epoch 34 iteration 1561: 0.3622678816318512
loss in epoch 35 iteration 1561: 0.3468886613845825
Evaluatingepoch:35, time: 10573361.967325(s), valid (NDCG@5: 0.5918, HR@5: 0.7351, NDCG@10: 0.6057, HR@10: 0.7776, NDCG@20: 0.6127, HR@20: 0.8055), test (NDCG@5: 0.5767, HR@5: 0.7228, NDCG@10: 0.5915, HR@10: 0.7675, NDCG@20: 0.5994, HR@20: 0.7989)
loss in epoch 36 iteration 1561: 0.34165269136428833
loss in epoch 37 iteration 1561: 0.34476238489151
loss in epoch 38 iteration 1561: 0.32921865582466125
loss in epoch 39 iteration 1561: 0.3112509846687317
loss in epoch 40 iteration 1561: 0.3414404094219208
Evaluatingepoch:40, time: 12083479.221582(s), valid (NDCG@5: 0.5923, HR@5: 0.7363, NDCG@10: 0.6058, HR@10: 0.7772, NDCG@20: 0.6131, HR@20: 0.8065), test (NDCG@5: 0.5790, HR@5: 0.7245, NDCG@10: 0.5938, HR@10: 0.7696, NDCG@20: 0.6017, HR@20: 0.8010)
loss in epoch 41 iteration 1561: 0.33541426062583923
loss in epoch 42 iteration 1561: 0.31696227192878723
loss in epoch 43 iteration 1561: 0.3186774253845215
loss in epoch 44 iteration 1561: 0.32041439414024353
loss in epoch 45 iteration 1561: 0.3111974596977234
Evaluatingepoch:45, time: 13593691.125870(s), valid (NDCG@5: 0.5969, HR@5: 0.7364, NDCG@10: 0.6104, HR@10: 0.7773, NDCG@20: 0.6177, HR@20: 0.8062), test (NDCG@5: 0.5831, HR@5: 0.7254, NDCG@10: 0.5975, HR@10: 0.7690, NDCG@20: 0.6055, HR@20: 0.8008)
loss in epoch 46 iteration 1561: 0.3204854726791382
loss in epoch 47 iteration 1561: 0.31304195523262024
loss in epoch 48 iteration 1561: 0.3214327096939087
loss in epoch 49 iteration 1561: 0.33132609724998474
loss in epoch 50 iteration 1561: 0.29841408133506775
Evaluatingepoch:50, time: 15103822.576284(s), valid (NDCG@5: 0.5983, HR@5: 0.7368, NDCG@10: 0.6118, HR@10: 0.7779, NDCG@20: 0.6192, HR@20: 0.8073), test (NDCG@5: 0.5833, HR@5: 0.7247, NDCG@10: 0.5983, HR@10: 0.7704, NDCG@20: 0.6054, HR@20: 0.7988)
loss in epoch 51 iteration 1561: 0.32324421405792236
loss in epoch 52 iteration 1561: 0.3047434687614441
loss in epoch 53 iteration 1561: 0.2917666733264923
loss in epoch 54 iteration 1561: 0.327790230512619
loss in epoch 55 iteration 1561: 0.3018524646759033
Evaluatingepoch:55, time: 16613929.563761(s), valid (NDCG@5: 0.5976, HR@5: 0.7375, NDCG@10: 0.6109, HR@10: 0.7780, NDCG@20: 0.6183, HR@20: 0.8073), test (NDCG@5: 0.5840, HR@5: 0.7262, NDCG@10: 0.5984, HR@10: 0.7701, NDCG@20: 0.6059, HR@20: 0.8001)
loss in epoch 56 iteration 1561: 0.29618048667907715
loss in epoch 57 iteration 1561: 0.29848331212997437
loss in epoch 58 iteration 1561: 0.2975670099258423
loss in epoch 59 iteration 1561: 0.30329859256744385
loss in epoch 60 iteration 1561: 0.30907735228538513
Evaluatingepoch:60, time: 18123963.747501(s), valid (NDCG@5: 0.5985, HR@5: 0.7389, NDCG@10: 0.6115, HR@10: 0.7784, NDCG@20: 0.6189, HR@20: 0.8079), test (NDCG@5: 0.5862, HR@5: 0.7264, NDCG@10: 0.6005, HR@10: 0.7698, NDCG@20: 0.6081, HR@20: 0.8002)
loss in epoch 61 iteration 1561: 0.3194383680820465
loss in epoch 62 iteration 1561: 0.31310349702835083
loss in epoch 63 iteration 1561: 0.30513665080070496
loss in epoch 64 iteration 1561: 0.3127487897872925
loss in epoch 65 iteration 1561: 0.2839381992816925
Evaluatingepoch:65, time: 19634124.564886(s), valid (NDCG@5: 0.5971, HR@5: 0.7379, NDCG@10: 0.6106, HR@10: 0.7789, NDCG@20: 0.6181, HR@20: 0.8089), test (NDCG@5: 0.5871, HR@5: 0.7287, NDCG@10: 0.6011, HR@10: 0.7711, NDCG@20: 0.6090, HR@20: 0.8026)
loss in epoch 66 iteration 1561: 0.2966712415218353
loss in epoch 67 iteration 1561: 0.30691763758659363
loss in epoch 68 iteration 1561: 0.3003937304019928
loss in epoch 69 iteration 1561: 0.31745320558547974
loss in epoch 70 iteration 1561: 0.29784899950027466
Evaluatingepoch:70, time: 21144323.103189(s), valid (NDCG@5: 0.6007, HR@5: 0.7384, NDCG@10: 0.6144, HR@10: 0.7800, NDCG@20: 0.6219, HR@20: 0.8099), test (NDCG@5: 0.5914, HR@5: 0.7284, NDCG@10: 0.6059, HR@10: 0.7726, NDCG@20: 0.6140, HR@20: 0.8047)
loss in epoch 71 iteration 1561: 0.30299410223960876
loss in epoch 72 iteration 1561: 0.29007238149642944
loss in epoch 73 iteration 1561: 0.27343201637268066
loss in epoch 74 iteration 1561: 0.3023427426815033
loss in epoch 75 iteration 1561: 0.29854816198349
Evaluatingepoch:75, time: 22654406.069756(s), valid (NDCG@5: 0.6048, HR@5: 0.7403, NDCG@10: 0.6181, HR@10: 0.7810, NDCG@20: 0.6255, HR@20: 0.8100), test (NDCG@5: 0.5936, HR@5: 0.7299, NDCG@10: 0.6075, HR@10: 0.7725, NDCG@20: 0.6155, HR@20: 0.8040)
loss in epoch 76 iteration 1561: 0.3126637637615204
loss in epoch 77 iteration 1561: 0.3108251690864563
loss in epoch 78 iteration 1561: 0.3008176386356354
loss in epoch 79 iteration 1561: 0.29745349287986755
loss in epoch 80 iteration 1561: 0.28313755989074707
Evaluatingepoch:80, time: 24164410.633564(s), valid (NDCG@5: 0.6081, HR@5: 0.7415, NDCG@10: 0.6214, HR@10: 0.7821, NDCG@20: 0.6286, HR@20: 0.8108), test (NDCG@5: 0.5960, HR@5: 0.7286, NDCG@10: 0.6113, HR@10: 0.7753, NDCG@20: 0.6190, HR@20: 0.8058)
loss in epoch 81 iteration 1561: 0.28316712379455566
loss in epoch 82 iteration 1561: 0.294533908367157
loss in epoch 83 iteration 1561: 0.2943935692310333
loss in epoch 84 iteration 1561: 0.30301356315612793
loss in epoch 85 iteration 1561: 0.28271403908729553
Evaluatingepoch:85, time: 25674394.997358(s), valid (NDCG@5: 0.6063, HR@5: 0.7422, NDCG@10: 0.6193, HR@10: 0.7816, NDCG@20: 0.6268, HR@20: 0.8116), test (NDCG@5: 0.5964, HR@5: 0.7304, NDCG@10: 0.6113, HR@10: 0.7757, NDCG@20: 0.6186, HR@20: 0.8050)
loss in epoch 86 iteration 1561: 0.28309452533721924
loss in epoch 87 iteration 1561: 0.2920114994049072
loss in epoch 88 iteration 1561: 0.2698802053928375
loss in epoch 89 iteration 1561: 0.2946613132953644
loss in epoch 90 iteration 1561: 0.2897740602493286
Evaluatingepoch:90, time: 27184969.935179(s), valid (NDCG@5: 0.6114, HR@5: 0.7425, NDCG@10: 0.6248, HR@10: 0.7834, NDCG@20: 0.6321, HR@20: 0.8123), test (NDCG@5: 0.5994, HR@5: 0.7312, NDCG@10: 0.6143, HR@10: 0.7768, NDCG@20: 0.6218, HR@20: 0.8066)
loss in epoch 91 iteration 1561: 0.2766106128692627
loss in epoch 92 iteration 1561: 0.28515931963920593
loss in epoch 93 iteration 1561: 0.30344411730766296
loss in epoch 94 iteration 1561: 0.29863548278808594
loss in epoch 95 iteration 1561: 0.2936604917049408
Evaluatingepoch:95, time: 28696400.262833(s), valid (NDCG@5: 0.6098, HR@5: 0.7417, NDCG@10: 0.6236, HR@10: 0.7837, NDCG@20: 0.6311, HR@20: 0.8136), test (NDCG@5: 0.6020, HR@5: 0.7329, NDCG@10: 0.6168, HR@10: 0.7780, NDCG@20: 0.6242, HR@20: 0.8072)
loss in epoch 96 iteration 1561: 0.28449058532714844
loss in epoch 97 iteration 1561: 0.29383575916290283
loss in epoch 98 iteration 1561: 0.28683069348335266
loss in epoch 99 iteration 1561: 0.3067939281463623
loss in epoch 100 iteration 1561: 0.30455464124679565
Evaluatingepoch:100, time: 30207733.281851(s), valid (NDCG@5: 0.6115, HR@5: 0.7423, NDCG@10: 0.6256, HR@10: 0.7854, NDCG@20: 0.6327, HR@20: 0.8137), test (NDCG@5: 0.6051, HR@5: 0.7332, NDCG@10: 0.6198, HR@10: 0.7782, NDCG@20: 0.6274, HR@20: 0.8082)
loss in epoch 101 iteration 1561: 0.286849707365036
loss in epoch 102 iteration 1561: 0.27941179275512695
loss in epoch 103 iteration 1561: 0.28979402780532837
loss in epoch 104 iteration 1561: 0.2992388606071472
loss in epoch 105 iteration 1561: 0.28438276052474976
Evaluatingepoch:105, time: 31718978.770971(s), valid (NDCG@5: 0.6140, HR@5: 0.7439, NDCG@10: 0.6281, HR@10: 0.7870, NDCG@20: 0.6352, HR@20: 0.8150), test (NDCG@5: 0.6042, HR@5: 0.7342, NDCG@10: 0.6191, HR@10: 0.7796, NDCG@20: 0.6266, HR@20: 0.8093)
loss in epoch 106 iteration 1561: 0.29648497700691223
loss in epoch 107 iteration 1561: 0.2791062593460083
loss in epoch 108 iteration 1561: 0.27858611941337585
loss in epoch 109 iteration 1561: 0.30632245540618896
loss in epoch 110 iteration 1561: 0.272676557302475
Evaluatingepoch:110, time: 33230108.907461(s), valid (NDCG@5: 0.6143, HR@5: 0.7453, NDCG@10: 0.6280, HR@10: 0.7870, NDCG@20: 0.6353, HR@20: 0.8162), test (NDCG@5: 0.6048, HR@5: 0.7337, NDCG@10: 0.6201, HR@10: 0.7804, NDCG@20: 0.6275, HR@20: 0.8098)
loss in epoch 111 iteration 1561: 0.2884414494037628
loss in epoch 112 iteration 1561: 0.2911507487297058
loss in epoch 113 iteration 1561: 0.29496636986732483
loss in epoch 114 iteration 1561: 0.2609120011329651
loss in epoch 115 iteration 1561: 0.2855948805809021
Evaluatingepoch:115, time: 34741553.101540(s), valid (NDCG@5: 0.6141, HR@5: 0.7439, NDCG@10: 0.6282, HR@10: 0.7871, NDCG@20: 0.6355, HR@20: 0.8158), test (NDCG@5: 0.6056, HR@5: 0.7352, NDCG@10: 0.6208, HR@10: 0.7815, NDCG@20: 0.6283, HR@20: 0.8112)
loss in epoch 116 iteration 1561: 0.2919631600379944
loss in epoch 117 iteration 1561: 0.24753767251968384
loss in epoch 118 iteration 1561: 0.27656880021095276
loss in epoch 119 iteration 1561: 0.2802640199661255
loss in epoch 120 iteration 1561: 0.2762574851512909
Evaluatingepoch:120, time: 36252819.805145(s), valid (NDCG@5: 0.6171, HR@5: 0.7453, NDCG@10: 0.6313, HR@10: 0.7886, NDCG@20: 0.6386, HR@20: 0.8175), test (NDCG@5: 0.6083, HR@5: 0.7345, NDCG@10: 0.6240, HR@10: 0.7825, NDCG@20: 0.6317, HR@20: 0.8132)
loss in epoch 121 iteration 1561: 0.2788551151752472
loss in epoch 122 iteration 1561: 0.2846773862838745
loss in epoch 123 iteration 1561: 0.2676319181919098
loss in epoch 124 iteration 1561: 0.2945408821105957
loss in epoch 125 iteration 1561: 0.2786429524421692
Evaluatingepoch:125, time: 37763993.782759(s), valid (NDCG@5: 0.6190, HR@5: 0.7451, NDCG@10: 0.6335, HR@10: 0.7892, NDCG@20: 0.6406, HR@20: 0.8173), test (NDCG@5: 0.6097, HR@5: 0.7351, NDCG@10: 0.6257, HR@10: 0.7838, NDCG@20: 0.6330, HR@20: 0.8126)
loss in epoch 126 iteration 1561: 0.3006376028060913
loss in epoch 127 iteration 1561: 0.2645759582519531
loss in epoch 128 iteration 1561: 0.272610604763031
loss in epoch 129 iteration 1561: 0.28821346163749695
loss in epoch 130 iteration 1561: 0.2806391417980194
Evaluatingepoch:130, time: 39274746.726274(s), valid (NDCG@5: 0.6200, HR@5: 0.7447, NDCG@10: 0.6343, HR@10: 0.7884, NDCG@20: 0.6415, HR@20: 0.8169), test (NDCG@5: 0.6105, HR@5: 0.7355, NDCG@10: 0.6263, HR@10: 0.7838, NDCG@20: 0.6338, HR@20: 0.8136)
loss in epoch 131 iteration 1561: 0.2637859582901001
loss in epoch 132 iteration 1561: 0.2621271312236786
loss in epoch 133 iteration 1561: 0.27666914463043213
loss in epoch 134 iteration 1561: 0.25701528787612915
loss in epoch 135 iteration 1561: 0.28558018803596497
Evaluatingepoch:135, time: 40785474.087238(s), valid (NDCG@5: 0.6200, HR@5: 0.7460, NDCG@10: 0.6341, HR@10: 0.7889, NDCG@20: 0.6414, HR@20: 0.8180), test (NDCG@5: 0.6083, HR@5: 0.7357, NDCG@10: 0.6241, HR@10: 0.7840, NDCG@20: 0.6318, HR@20: 0.8144)
loss in epoch 136 iteration 1561: 0.2753283679485321
loss in epoch 137 iteration 1561: 0.2773280739784241
loss in epoch 138 iteration 1561: 0.28149715065956116
loss in epoch 139 iteration 1561: 0.28760889172554016
loss in epoch 140 iteration 1561: 0.28595420718193054
Evaluatingepoch:140, time: 42296284.071922(s), valid (NDCG@5: 0.6229, HR@5: 0.7479, NDCG@10: 0.6368, HR@10: 0.7904, NDCG@20: 0.6439, HR@20: 0.8184), test (NDCG@5: 0.6119, HR@5: 0.7359, NDCG@10: 0.6277, HR@10: 0.7842, NDCG@20: 0.6355, HR@20: 0.8150)
loss in epoch 141 iteration 1561: 0.27511534094810486
loss in epoch 142 iteration 1561: 0.2684023082256317
loss in epoch 143 iteration 1561: 0.28787899017333984
loss in epoch 144 iteration 1561: 0.282357394695282
loss in epoch 145 iteration 1561: 0.2715175747871399
Evaluatingepoch:145, time: 43806945.568085(s), valid (NDCG@5: 0.6229, HR@5: 0.7475, NDCG@10: 0.6371, HR@10: 0.7906, NDCG@20: 0.6442, HR@20: 0.8189), test (NDCG@5: 0.6129, HR@5: 0.7359, NDCG@10: 0.6287, HR@10: 0.7846, NDCG@20: 0.6363, HR@20: 0.8146)
loss in epoch 146 iteration 1561: 0.28913792967796326
loss in epoch 147 iteration 1561: 0.2828763425350189
loss in epoch 148 iteration 1561: 0.2629914879798889
loss in epoch 149 iteration 1561: 0.26856645941734314
loss in epoch 150 iteration 1561: 0.27399176359176636
Evaluatingepoch:150, time: 45317641.017199(s), valid (NDCG@5: 0.6257, HR@5: 0.7473, NDCG@10: 0.6397, HR@10: 0.7900, NDCG@20: 0.6468, HR@20: 0.8182), test (NDCG@5: 0.6155, HR@5: 0.7374, NDCG@10: 0.6310, HR@10: 0.7846, NDCG@20: 0.6387, HR@20: 0.8151)
loss in epoch 151 iteration 1561: 0.2843574285507202
loss in epoch 152 iteration 1561: 0.2768480181694031
loss in epoch 153 iteration 1561: 0.26519396901130676
loss in epoch 154 iteration 1561: 0.2621186375617981
loss in epoch 155 iteration 1561: 0.26792261004447937
Evaluatingepoch:155, time: 46828104.580164(s), valid (NDCG@5: 0.6242, HR@5: 0.7483, NDCG@10: 0.6381, HR@10: 0.7906, NDCG@20: 0.6453, HR@20: 0.8194), test (NDCG@5: 0.6169, HR@5: 0.7376, NDCG@10: 0.6323, HR@10: 0.7848, NDCG@20: 0.6399, HR@20: 0.8149)
loss in epoch 156 iteration 1561: 0.28164687752723694
loss in epoch 157 iteration 1561: 0.27984702587127686
loss in epoch 158 iteration 1561: 0.25896313786506653
loss in epoch 159 iteration 1561: 0.2613540291786194
loss in epoch 160 iteration 1561: 0.2693030536174774
Evaluatingepoch:160, time: 48339052.103043(s), valid (NDCG@5: 0.6248, HR@5: 0.7467, NDCG@10: 0.6391, HR@10: 0.7905, NDCG@20: 0.6466, HR@20: 0.8201), test (NDCG@5: 0.6166, HR@5: 0.7372, NDCG@10: 0.6322, HR@10: 0.7850, NDCG@20: 0.6402, HR@20: 0.8168)
loss in epoch 161 iteration 1561: 0.276599258184433
loss in epoch 162 iteration 1561: 0.26992830634117126
loss in epoch 163 iteration 1561: 0.2718377113342285
loss in epoch 164 iteration 1561: 0.2725432515144348
