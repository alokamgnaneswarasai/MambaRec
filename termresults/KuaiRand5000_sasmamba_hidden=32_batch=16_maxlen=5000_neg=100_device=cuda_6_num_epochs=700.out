Arguments:
backbone sasmamba
batch_size 16
dataset KuaiRand5000
device cuda:6
dropout_rate 0.5
eval_neg_sample 100
hidden_units 32
inference_only False
l2_emb 0.0
lr 0.0005
maxlen 5000
name mamba
num_blocks 2
num_epochs 700
num_heads 1
state_dict_path None
train_dir tracks256_default/

user_count: 26858
item count: 8825518
26858
average sequence length: 2159.58
parameters_count: 1025424929
loss in epoch 1 iteration 1677: 0.8664724230766296
loss in epoch 2 iteration 1677: 0.7558131217956543
loss in epoch 3 iteration 1677: 0.7661007046699524
loss in epoch 4 iteration 1677: 0.6488507986068726
loss in epoch 5 iteration 1677: 0.615627646446228
Evaluatingepoch:5, time: 2316295.857191(s), valid (NDCG@5: 0.6118, HR@5: 0.7631, NDCG@10: 0.6347, HR@10: 0.8332, NDCG@20: 0.6462, HR@20: 0.8782), test (NDCG@5: 0.6126, HR@5: 0.7644, NDCG@10: 0.6369, HR@10: 0.8383, NDCG@20: 0.6486, HR@20: 0.8842)
loss in epoch 6 iteration 1677: 0.6130605340003967
loss in epoch 7 iteration 1677: 0.5631376504898071
loss in epoch 8 iteration 1677: 0.5075659155845642
loss in epoch 9 iteration 1677: 0.5250253677368164
loss in epoch 10 iteration 1677: 0.49523600935935974
Evaluatingepoch:10, time: 4586145.366192(s), valid (NDCG@5: 0.6194, HR@5: 0.7687, NDCG@10: 0.6416, HR@10: 0.8367, NDCG@20: 0.6527, HR@20: 0.8802), test (NDCG@5: 0.6179, HR@5: 0.7700, NDCG@10: 0.6409, HR@10: 0.8407, NDCG@20: 0.6526, HR@20: 0.8864)
loss in epoch 11 iteration 1677: 0.488925576210022
loss in epoch 12 iteration 1677: 0.43561744689941406
loss in epoch 13 iteration 1677: 0.41133779287338257
loss in epoch 14 iteration 1677: 0.412939190864563
loss in epoch 15 iteration 1677: 0.3928917646408081
Evaluatingepoch:15, time: 6856054.261208(s), valid (NDCG@5: 0.6533, HR@5: 0.7805, NDCG@10: 0.6731, HR@10: 0.8411, NDCG@20: 0.6825, HR@20: 0.8782), test (NDCG@5: 0.6514, HR@5: 0.7804, NDCG@10: 0.6721, HR@10: 0.8439, NDCG@20: 0.6827, HR@20: 0.8859)
loss in epoch 16 iteration 1677: 0.3515973687171936
loss in epoch 17 iteration 1677: 0.33783671259880066
loss in epoch 18 iteration 1677: 0.3441424071788788
loss in epoch 19 iteration 1677: 0.32794904708862305
loss in epoch 20 iteration 1677: 0.31662699580192566
Evaluatingepoch:20, time: 9125746.777534(s), valid (NDCG@5: 0.6766, HR@5: 0.7916, NDCG@10: 0.6935, HR@10: 0.8432, NDCG@20: 0.7029, HR@20: 0.8799), test (NDCG@5: 0.6747, HR@5: 0.7946, NDCG@10: 0.6929, HR@10: 0.8501, NDCG@20: 0.7019, HR@20: 0.8855)
loss in epoch 21 iteration 1677: 0.2949160933494568
loss in epoch 22 iteration 1677: 0.28846845030784607
loss in epoch 23 iteration 1677: 0.2866654396057129
loss in epoch 24 iteration 1677: 0.28908926248550415
loss in epoch 25 iteration 1677: 0.26985040307044983
Evaluatingepoch:25, time: 11394682.298183(s), valid (NDCG@5: 0.6862, HR@5: 0.7976, NDCG@10: 0.7024, HR@10: 0.8473, NDCG@20: 0.7108, HR@20: 0.8805), test (NDCG@5: 0.6850, HR@5: 0.7991, NDCG@10: 0.7018, HR@10: 0.8505, NDCG@20: 0.7107, HR@20: 0.8858)
loss in epoch 26 iteration 1677: 0.280219167470932
loss in epoch 27 iteration 1677: 0.28240564465522766
loss in epoch 28 iteration 1677: 0.2367401123046875
loss in epoch 29 iteration 1677: 0.24371390044689178
loss in epoch 30 iteration 1677: 0.26947271823883057
Evaluatingepoch:30, time: 13663746.568441(s), valid (NDCG@5: 0.6932, HR@5: 0.7989, NDCG@10: 0.7094, HR@10: 0.8482, NDCG@20: 0.7180, HR@20: 0.8823), test (NDCG@5: 0.6906, HR@5: 0.8014, NDCG@10: 0.7074, HR@10: 0.8527, NDCG@20: 0.7160, HR@20: 0.8865)
loss in epoch 31 iteration 1677: 0.2764115035533905
loss in epoch 32 iteration 1677: 0.2515568137168884
loss in epoch 33 iteration 1677: 0.23442362248897552
loss in epoch 34 iteration 1677: 0.2475590705871582
loss in epoch 35 iteration 1677: 0.21389047801494598
Evaluatingepoch:35, time: 15933598.588705(s), valid (NDCG@5: 0.6960, HR@5: 0.8014, NDCG@10: 0.7114, HR@10: 0.8486, NDCG@20: 0.7196, HR@20: 0.8807), test (NDCG@5: 0.6938, HR@5: 0.8031, NDCG@10: 0.7092, HR@10: 0.8502, NDCG@20: 0.7183, HR@20: 0.8858)
loss in epoch 36 iteration 1677: 0.21372966468334198
loss in epoch 37 iteration 1677: 0.22213700413703918
loss in epoch 38 iteration 1677: 0.2366866171360016
loss in epoch 39 iteration 1677: 0.22357314825057983
loss in epoch 40 iteration 1677: 0.2299196720123291
Evaluatingepoch:40, time: 18203752.060175(s), valid (NDCG@5: 0.7019, HR@5: 0.8041, NDCG@10: 0.7163, HR@10: 0.8482, NDCG@20: 0.7249, HR@20: 0.8821), test (NDCG@5: 0.7009, HR@5: 0.8071, NDCG@10: 0.7157, HR@10: 0.8525, NDCG@20: 0.7244, HR@20: 0.8870)
loss in epoch 41 iteration 1677: 0.24374793469905853
loss in epoch 42 iteration 1677: 0.21150322258472443
loss in epoch 43 iteration 1677: 0.21537093818187714
loss in epoch 44 iteration 1677: 0.21365812420845032
loss in epoch 45 iteration 1677: 0.22278738021850586
Evaluatingepoch:45, time: 20474978.585720(s), valid (NDCG@5: 0.7054, HR@5: 0.8081, NDCG@10: 0.7194, HR@10: 0.8512, NDCG@20: 0.7275, HR@20: 0.8831), test (NDCG@5: 0.7043, HR@5: 0.8096, NDCG@10: 0.7190, HR@10: 0.8546, NDCG@20: 0.7275, HR@20: 0.8880)
loss in epoch 46 iteration 1677: 0.2263367921113968
loss in epoch 47 iteration 1677: 0.2084789127111435
loss in epoch 48 iteration 1677: 0.20849724113941193
loss in epoch 49 iteration 1677: 0.21706171333789825
loss in epoch 50 iteration 1677: 0.20942193269729614
Evaluatingepoch:50, time: 22745354.299068(s), valid (NDCG@5: 0.7037, HR@5: 0.8059, NDCG@10: 0.7181, HR@10: 0.8502, NDCG@20: 0.7263, HR@20: 0.8822), test (NDCG@5: 0.7028, HR@5: 0.8083, NDCG@10: 0.7178, HR@10: 0.8539, NDCG@20: 0.7261, HR@20: 0.8866)
loss in epoch 51 iteration 1677: 0.2189813256263733
loss in epoch 52 iteration 1677: 0.2021574079990387
loss in epoch 53 iteration 1677: 0.20875482261180878
loss in epoch 54 iteration 1677: 0.20747412741184235
loss in epoch 55 iteration 1677: 0.19349656999111176
Evaluatingepoch:55, time: 25012178.242207(s), valid (NDCG@5: 0.7078, HR@5: 0.8083, NDCG@10: 0.7224, HR@10: 0.8532, NDCG@20: 0.7302, HR@20: 0.8838), test (NDCG@5: 0.7089, HR@5: 0.8124, NDCG@10: 0.7235, HR@10: 0.8574, NDCG@20: 0.7316, HR@20: 0.8891)
loss in epoch 56 iteration 1677: 0.1996842324733734
loss in epoch 57 iteration 1677: 0.19394594430923462
loss in epoch 58 iteration 1677: 0.19587557017803192
loss in epoch 59 iteration 1677: 0.2042592167854309
loss in epoch 60 iteration 1677: 0.18958032131195068
Evaluatingepoch:60, time: 27279537.094355(s), valid (NDCG@5: 0.7095, HR@5: 0.8097, NDCG@10: 0.7239, HR@10: 0.8538, NDCG@20: 0.7318, HR@20: 0.8849), test (NDCG@5: 0.7094, HR@5: 0.8127, NDCG@10: 0.7239, HR@10: 0.8572, NDCG@20: 0.7321, HR@20: 0.8891)
loss in epoch 61 iteration 1677: 0.20257502794265747
loss in epoch 62 iteration 1677: 0.19252941012382507
loss in epoch 63 iteration 1677: 0.2073248326778412
loss in epoch 64 iteration 1677: 0.19465942680835724
loss in epoch 65 iteration 1677: 0.1987329125404358
Evaluatingepoch:65, time: 29544944.537163(s), valid (NDCG@5: 0.7135, HR@5: 0.8139, NDCG@10: 0.7277, HR@10: 0.8570, NDCG@20: 0.7353, HR@20: 0.8869), test (NDCG@5: 0.7131, HR@5: 0.8149, NDCG@10: 0.7281, HR@10: 0.8609, NDCG@20: 0.7359, HR@20: 0.8916)
loss in epoch 66 iteration 1677: 0.19203273952007294
loss in epoch 67 iteration 1677: 0.18641814589500427
loss in epoch 68 iteration 1677: 0.20156198740005493
loss in epoch 69 iteration 1677: 0.19493192434310913
loss in epoch 70 iteration 1677: 0.20526419579982758
Evaluatingepoch:70, time: 31809505.512476(s), valid (NDCG@5: 0.7132, HR@5: 0.8137, NDCG@10: 0.7276, HR@10: 0.8578, NDCG@20: 0.7355, HR@20: 0.8886), test (NDCG@5: 0.7123, HR@5: 0.8160, NDCG@10: 0.7276, HR@10: 0.8628, NDCG@20: 0.7357, HR@20: 0.8945)
loss in epoch 71 iteration 1677: 0.19528041779994965
loss in epoch 72 iteration 1677: 0.20872634649276733
loss in epoch 73 iteration 1677: 0.1934172660112381
loss in epoch 74 iteration 1677: 0.19484692811965942
loss in epoch 75 iteration 1677: 0.19489489495754242
Evaluatingepoch:75, time: 34073048.625231(s), valid (NDCG@5: 0.7145, HR@5: 0.8150, NDCG@10: 0.7292, HR@10: 0.8603, NDCG@20: 0.7370, HR@20: 0.8909), test (NDCG@5: 0.7162, HR@5: 0.8174, NDCG@10: 0.7315, HR@10: 0.8642, NDCG@20: 0.7394, HR@20: 0.8952)
loss in epoch 76 iteration 1677: 0.1982658952474594
loss in epoch 77 iteration 1677: 0.19772131741046906
loss in epoch 78 iteration 1677: 0.19617819786071777
loss in epoch 79 iteration 1677: 0.1944957971572876
loss in epoch 80 iteration 1677: 0.19767537713050842
Evaluatingepoch:80, time: 36414514.472723(s), valid (NDCG@5: 0.7201, HR@5: 0.8184, NDCG@10: 0.7344, HR@10: 0.8622, NDCG@20: 0.7419, HR@20: 0.8919), test (NDCG@5: 0.7189, HR@5: 0.8193, NDCG@10: 0.7342, HR@10: 0.8663, NDCG@20: 0.7421, HR@20: 0.8973)
loss in epoch 81 iteration 1677: 0.19406627118587494
loss in epoch 82 iteration 1677: 0.21212519705295563
loss in epoch 83 iteration 1677: 0.19973556697368622
loss in epoch 84 iteration 1677: 0.1943029761314392
loss in epoch 85 iteration 1677: 0.19140157103538513
Evaluatingepoch:85, time: 38671571.123362(s), valid (NDCG@5: 0.7206, HR@5: 0.8188, NDCG@10: 0.7349, HR@10: 0.8627, NDCG@20: 0.7427, HR@20: 0.8934), test (NDCG@5: 0.7212, HR@5: 0.8206, NDCG@10: 0.7361, HR@10: 0.8663, NDCG@20: 0.7440, HR@20: 0.8976)
loss in epoch 86 iteration 1677: 0.19161608815193176
loss in epoch 87 iteration 1677: 0.19324159622192383
loss in epoch 88 iteration 1677: 0.19143781065940857
loss in epoch 89 iteration 1677: 0.20286953449249268
loss in epoch 90 iteration 1677: 0.19997361302375793
Evaluatingepoch:90, time: 40935860.111713(s), valid (NDCG@5: 0.7229, HR@5: 0.8210, NDCG@10: 0.7367, HR@10: 0.8636, NDCG@20: 0.7447, HR@20: 0.8950), test (NDCG@5: 0.7191, HR@5: 0.8203, NDCG@10: 0.7348, HR@10: 0.8682, NDCG@20: 0.7429, HR@20: 0.8998)
loss in epoch 91 iteration 1677: 0.1942339837551117
loss in epoch 92 iteration 1677: 0.19279202818870544
loss in epoch 93 iteration 1677: 0.19276870787143707
loss in epoch 94 iteration 1677: 0.20464545488357544
loss in epoch 95 iteration 1677: 0.18772824108600616
Evaluatingepoch:95, time: 43199906.188011(s), valid (NDCG@5: 0.7230, HR@5: 0.8197, NDCG@10: 0.7378, HR@10: 0.8648, NDCG@20: 0.7455, HR@20: 0.8952), test (NDCG@5: 0.7245, HR@5: 0.8245, NDCG@10: 0.7391, HR@10: 0.8694, NDCG@20: 0.7473, HR@20: 0.9016)
loss in epoch 96 iteration 1677: 0.2011079490184784
loss in epoch 97 iteration 1677: 0.1999129205942154
loss in epoch 98 iteration 1677: 0.21249434351921082
loss in epoch 99 iteration 1677: 0.19533799588680267
loss in epoch 100 iteration 1677: 0.20841899514198303
Evaluatingepoch:100, time: 45462191.302538(s), valid (NDCG@5: 0.7275, HR@5: 0.8219, NDCG@10: 0.7415, HR@10: 0.8648, NDCG@20: 0.7495, HR@20: 0.8961), test (NDCG@5: 0.7255, HR@5: 0.8238, NDCG@10: 0.7406, HR@10: 0.8699, NDCG@20: 0.7486, HR@20: 0.9013)
loss in epoch 101 iteration 1677: 0.19105264544487
loss in epoch 102 iteration 1677: 0.2009463906288147
loss in epoch 103 iteration 1677: 0.19692057371139526
loss in epoch 104 iteration 1677: 0.1892683506011963
loss in epoch 105 iteration 1677: 0.19090381264686584
Evaluatingepoch:105, time: 47723799.664736(s), valid (NDCG@5: 0.7265, HR@5: 0.8218, NDCG@10: 0.7407, HR@10: 0.8653, NDCG@20: 0.7485, HR@20: 0.8962), test (NDCG@5: 0.7274, HR@5: 0.8263, NDCG@10: 0.7422, HR@10: 0.8715, NDCG@20: 0.7498, HR@20: 0.9013)
loss in epoch 106 iteration 1677: 0.18902891874313354
loss in epoch 107 iteration 1677: 0.19920596480369568
loss in epoch 108 iteration 1677: 0.1886996179819107
loss in epoch 109 iteration 1677: 0.1871536821126938
loss in epoch 110 iteration 1677: 0.18923519551753998
Evaluatingepoch:110, time: 49986245.265961(s), valid (NDCG@5: 0.7328, HR@5: 0.8265, NDCG@10: 0.7465, HR@10: 0.8684, NDCG@20: 0.7538, HR@20: 0.8972), test (NDCG@5: 0.7328, HR@5: 0.8279, NDCG@10: 0.7475, HR@10: 0.8729, NDCG@20: 0.7552, HR@20: 0.9034)
loss in epoch 111 iteration 1677: 0.1867682784795761
loss in epoch 112 iteration 1677: 0.17932018637657166
loss in epoch 113 iteration 1677: 0.1948636770248413
loss in epoch 114 iteration 1677: 0.1856013536453247
loss in epoch 115 iteration 1677: 0.19086050987243652
Evaluatingepoch:115, time: 52247756.711245(s), valid (NDCG@5: 0.7273, HR@5: 0.8244, NDCG@10: 0.7410, HR@10: 0.8662, NDCG@20: 0.7488, HR@20: 0.8970), test (NDCG@5: 0.7283, HR@5: 0.8266, NDCG@10: 0.7427, HR@10: 0.8709, NDCG@20: 0.7508, HR@20: 0.9027)
loss in epoch 116 iteration 1677: 0.19320043921470642
loss in epoch 117 iteration 1677: 0.19341585040092468
loss in epoch 118 iteration 1677: 0.18703287839889526
loss in epoch 119 iteration 1677: 0.18592281639575958
loss in epoch 120 iteration 1677: 0.18119022250175476
Evaluatingepoch:120, time: 54508605.838299(s), valid (NDCG@5: 0.7349, HR@5: 0.8260, NDCG@10: 0.7489, HR@10: 0.8688, NDCG@20: 0.7562, HR@20: 0.8975), test (NDCG@5: 0.7344, HR@5: 0.8298, NDCG@10: 0.7486, HR@10: 0.8732, NDCG@20: 0.7563, HR@20: 0.9037)
loss in epoch 121 iteration 1677: 0.18475165963172913
loss in epoch 122 iteration 1677: 0.188786581158638
loss in epoch 123 iteration 1677: 0.18958622217178345
loss in epoch 124 iteration 1677: 0.18626053631305695
loss in epoch 125 iteration 1677: 0.17931966483592987
Evaluatingepoch:125, time: 56770295.116186(s), valid (NDCG@5: 0.7347, HR@5: 0.8268, NDCG@10: 0.7480, HR@10: 0.8677, NDCG@20: 0.7557, HR@20: 0.8980), test (NDCG@5: 0.7358, HR@5: 0.8313, NDCG@10: 0.7499, HR@10: 0.8744, NDCG@20: 0.7571, HR@20: 0.9028)
loss in epoch 126 iteration 1677: 0.1870269924402237
loss in epoch 127 iteration 1677: 0.18777327239513397
loss in epoch 128 iteration 1677: 0.18424877524375916
loss in epoch 129 iteration 1677: 0.18835535645484924
loss in epoch 130 iteration 1677: 0.18814343214035034
Evaluatingepoch:130, time: 59031831.509113(s), valid (NDCG@5: 0.7337, HR@5: 0.8278, NDCG@10: 0.7468, HR@10: 0.8681, NDCG@20: 0.7543, HR@20: 0.8975), test (NDCG@5: 0.7332, HR@5: 0.8303, NDCG@10: 0.7472, HR@10: 0.8731, NDCG@20: 0.7551, HR@20: 0.9043)
loss in epoch 131 iteration 1677: 0.18778036534786224
loss in epoch 132 iteration 1677: 0.1859443336725235
loss in epoch 133 iteration 1677: 0.18651437759399414
loss in epoch 134 iteration 1677: 0.1818564385175705
loss in epoch 135 iteration 1677: 0.18280163407325745
Evaluatingepoch:135, time: 61292720.640421(s), valid (NDCG@5: 0.7354, HR@5: 0.8285, NDCG@10: 0.7482, HR@10: 0.8681, NDCG@20: 0.7560, HR@20: 0.8982), test (NDCG@5: 0.7350, HR@5: 0.8317, NDCG@10: 0.7493, HR@10: 0.8755, NDCG@20: 0.7564, HR@20: 0.9033)
loss in epoch 136 iteration 1677: 0.18416814506053925
loss in epoch 137 iteration 1677: 0.1850917488336563
loss in epoch 138 iteration 1677: 0.18664279580116272
loss in epoch 139 iteration 1677: 0.18361230194568634
loss in epoch 140 iteration 1677: 0.17649966478347778
Evaluatingepoch:140, time: 63554083.444357(s), valid (NDCG@5: 0.7340, HR@5: 0.8282, NDCG@10: 0.7470, HR@10: 0.8681, NDCG@20: 0.7546, HR@20: 0.8982), test (NDCG@5: 0.7326, HR@5: 0.8299, NDCG@10: 0.7468, HR@10: 0.8734, NDCG@20: 0.7545, HR@20: 0.9038)
loss in epoch 141 iteration 1677: 0.18061433732509613
loss in epoch 142 iteration 1677: 0.17938953638076782
loss in epoch 143 iteration 1677: 0.17697353661060333
loss in epoch 144 iteration 1677: 0.18746860325336456
loss in epoch 145 iteration 1677: 0.17717941105365753
Evaluatingepoch:145, time: 65815567.415953(s), valid (NDCG@5: 0.7371, HR@5: 0.8270, NDCG@10: 0.7508, HR@10: 0.8693, NDCG@20: 0.7583, HR@20: 0.8988), test (NDCG@5: 0.7361, HR@5: 0.8307, NDCG@10: 0.7503, HR@10: 0.8741, NDCG@20: 0.7576, HR@20: 0.9029)
loss in epoch 146 iteration 1677: 0.1739417463541031
loss in epoch 147 iteration 1677: 0.18516018986701965
loss in epoch 148 iteration 1677: 0.1708369106054306
loss in epoch 149 iteration 1677: 0.17189711332321167
loss in epoch 150 iteration 1677: 0.17920519411563873
Evaluatingepoch:150, time: 68075178.479671(s), valid (NDCG@5: 0.7363, HR@5: 0.8282, NDCG@10: 0.7494, HR@10: 0.8685, NDCG@20: 0.7570, HR@20: 0.8985), test (NDCG@5: 0.7350, HR@5: 0.8322, NDCG@10: 0.7488, HR@10: 0.8745, NDCG@20: 0.7561, HR@20: 0.9033)
loss in epoch 151 iteration 1677: 0.16910474002361298
loss in epoch 152 iteration 1677: 0.1766359508037567
loss in epoch 153 iteration 1677: 0.18210694193840027
loss in epoch 154 iteration 1677: 0.18262918293476105
loss in epoch 155 iteration 1677: 0.18127627670764923
Evaluatingepoch:155, time: 70338263.133287(s), valid (NDCG@5: 0.7355, HR@5: 0.8280, NDCG@10: 0.7490, HR@10: 0.8692, NDCG@20: 0.7564, HR@20: 0.8987), test (NDCG@5: 0.7375, HR@5: 0.8319, NDCG@10: 0.7513, HR@10: 0.8740, NDCG@20: 0.7589, HR@20: 0.9038)
loss in epoch 156 iteration 1677: 0.17597737908363342
loss in epoch 157 iteration 1677: 0.16900